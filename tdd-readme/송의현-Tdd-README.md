## TDD 학습 과정 정리
TDD 가 무엇인지에 대한 이해를 우선적으로 하려고 하였습니다  
RED-GREEN-REFACTOR 가 무엇을 의미하는지 공부를 하였고   
처음엔 RED, GREEN 의 의미를 잘 파익하지 못한채 RED 는 예외상황에 대한 테스트 코드, GREEN 은 성공상황으로 TDD 를 진행하였는데  
TDD 의 RED 는 테스트할 코드의 작성이 되지 않은 상태에서 테스트 코드만 작성하는 것이였고  
GREEN 은 테스트할 코드가 작성이 완료되어 TEST 결과가 GREEN 이 나온다는 의미로 다시 확인을 하는 과정이 있었습니다.

이후 테스트 코드를 작성할때는 interface, service, infra 계층에서 각각 어떤 환경 설정이 되어야하는지에 대한 공부를 진행하며 작성하였습니다  
DDD 를 적용하며 테스트하기 좋은 코드는 어떤 코드인지 DIP 를 하면 왜 테스트하기가 수월해 지는지를 이론만이 아닌 경험을 통해서 확실하게 느끼게 되었습니다  

또한 TEST 코드를 미리 작성하는 과정에 있어서 내가 작성할 메서드의 책임과 역할에 대한 고민을 깊게하게 되었습니다

## 각 Step별 학습 내용과 느낀 점

### TDD 기초와 도메인 모델 테스트 단계

도메인 로직의 기능에 대해 생각해보고  
RED-GREEN 패턴에 대해서 공부하는 과정이였습니다  
도메인 테스트의 경우 작성을 미리 해놓아야 나중에 로직 확장이나 빼먹은 부분에 잇어서 확인이 빠르게 될 수 있겠다고 느꼈습니다

### 서비스 레이어 테스트와 Mock 활용

서비스 메서드의 역할과 책임은 어디까지인지 고민하는 시간이였습니다  
DIP 를 잘 지키는 것이 왜 TEST 에 유리한지 경험해볼 수 있는 시간이였고 외부 주입을 어떤것을 해야하는지  
테스트 환경에서 사용하지 않더라도 테스트하려는 Service 에 주입이 되어있다면 Mock 처리를 해야하는 부분 등  
테스트 코드 기본에 대해서 조금 더 잘 알게되고 픽스쳐 관리에 대한 경험을 할 수 있었습니다

### 서비스 레이어 테스트와 Mock 활용

DataJpaTest 에 대해서 이해하는 시간이였습니다
기본적으로 인메모리db 를 통해서 테스트를 하려고 하는 어노테이션으로 실 DB 환경과 맞추려면 Replace.NONE 설정을 해야합니다  
또한 repo단위 테스트가 아닌 repoImpl 의 부분 통합테스트를 진행하였는데 Import 에서 한개를 빼먹어서 ApplicationContext 전체가 뜨지 않는 오류로  
가장 시간을 많이 들어갔던 테스트로 주입받는 Bean 들에 대한 Import 를 빼먹지 않아야 한다는 부분을 다시 느낄 수 있었고  
mapStruct, modelMapper 에 관한 테스트 어려움성에 있어서도 repo -> domain 부분에서는 mapper 를 사용해서 매핑하는 것이 좋다고 생각되었습니다    
테스트 복잡성은 각각 따로 매핑후 Impl 에서 조합을 해서 내보내거나 하는 방법 또는 통합매퍼에서 각 매퍼를 주입받은 구현체로 만들고 매핑을 진행하는 등으로  
테스트 과정에서 단순하게 만들 수 있다는 인사이트를 얻게 되었습니다 

페이징 관련된 메서드를 테스트하는 과정에서 InstanceIo 를 통해서 대량의 데이터를 단순하게 주입하는 방법으로 테스트 데이터를 관리하였습니다  
많은 데이터 중복되지 않아야하는 조건이 걸린 상황에서 많은 데이터를 손으로 작성하는 것보다 라이브러리를 사용해서 관리하는 것이 개발속도에서 유리하고  
테스트에 필요한 특정 객체는 따로 생성하여 추가하면 되어 테스트의 결과에도 어느정도 신뢰성을 확보할 수 있어 선택하였습니다

### 컨트롤러 테스트

컨트롤러 테스트에서는 Security 필터에서 걸리는 부분에 대해 테스트용 Security 구성을 해서 jwt 인증은 비활성화 후 입력과 결과에 대한 테스트만 진행하였습니다  
SecurityFilter 가 어느단에 위치하는지 DispatcherServlet 의 위치등을 자세하게 알게되었습니다  

### E2E

SpringBootTest 를 통해 전체 Bean 을 띄우고 진행하는 테스트로  
각 단위테스트에서 발견되지 않았던 문제점을 파악 할 수 있었습니다 테스트 구성 자체는 SpringBootTest 로 진행하여 어렵지 않았지만  
구성하는 시간에 비해서 발견된 문제들이 많아 통합테스트의 중요성에 대해 알게되었습니다  
또한 단위테스트를 잘 작성해놓아 리팩터링 시간이 굉장히 감소하였습니다  
어떤 부분에서 테스트통과가 안 되는지에 대한 파악이 빠르게 되어   
TDD 는 초기 개발시간이 조금 걸리지만 유지보수에 강한 개발방법이라는 것을 경험할 수 있게 해주는 단계였습니다

## 테스트 전략 설명

각 메서드에 대하여 성공상황과 예외상황을 1가지씩 두고 테스트를 진행하였습니다  
특정 입력값에 대한 결과값을 검증하는 식으로 테스트를 진행하였습니다  
메서드에 대한 테스트를 Nested 로 묶고 내부에 테스트 케이스를 추가하는 방식으로 테스트 코드 가독성을 높였습니다  
픽스쳐는 InstanceIo 를 통해서 관리하였습니다 특정 필드에 관한 검증은 set 을 통해 고정시키는 방식으로 해결하였습니다

## 회고

테스트에 익숙해질 수 있는 시간이였고 Test 코드가 주는 이점에 대해 경험할 수 있었다  
특히 기존 도메인 로직을 변경하거나 필드가 추가될때 검증하는 과정에 있어서 Test 코드가 있을때 와 없을때의 차이를 경험을 통해 알게 되었고  
SRP, DIP 등 객체지향설계의 기본을 지켜야 TDD 가 쉬워져 Test 하기 좋은 코드는 무엇일까에 대한 고민하게 되었고  
객체지향 설계원칙을 기본으로 두어야 그 뒤의 DDD, TDD, 헥사고날등 의 이론을 적용할 수 있겠다는 생각이 들었습니다